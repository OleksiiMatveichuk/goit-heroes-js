import{l as q,c as Z,a as N,b as B,r as J,i as M}from"./header-82f447ae.js";async function K(e,n,t,i,o){let r=Math.ceil(n/e);document.createElement("div").classList.add("my-pagination");const j=await R(),z=await Y(j.join(""));function D(l){return l==="..."?i===1||i>t-3?"prev":"next":`Page ${l}`}function F(l){return l===i?`<bitton class="pagination-number active" page-index=${l} aria-label='Page ${l}'>${l}</bitton>`:`<bitton class="pagination-number" page-index=${l} aria-label=${D(l)}>${l}</bitton>`}async function R(l){return U().map(d=>F(d))}function U(l){const a=[];for(let d=1;d<=r;d++)a.push(d);return r<=t?a:i!==r?(o==null?void 0:o.direction)===">"?r-i>=t?(a.splice(1,0,"..."),a.splice(2,i-1),a.splice(t-2,0,"...",r),a.splice(t,a.length-1),a):(a.splice(1,0,"..."),a.splice(2,i-4),a):(o==null?void 0:o.direction)==="<"?r-i<=t?(a.splice(1,0,"..."),a.splice(2,i-t+2),a.splice(t-2,t,"...",r),a):i>t?(a.splice(1,0,"..."),a.splice(2,i-t+1),a.splice(t-1,a.length,"...",r),a):(a.splice(t-2,0,"...",r),a.splice(t,a.length-1),a):(a.splice(t-2,0,"...",r),a.splice(t,a.length-1),a):(a.splice(1,0,"..."),a.splice(2,a.length-t),a)}async function Y(l){return`
        <nav class="pagination-container">
      <button class="pagination-button" id="prev-button" title="Previous page" aria-label="Previous page">
       &lt;
      </button>
  
      <div id="pagination-numbers">

     ${l}

     </div>
  
     <button class="pagination-button" id="next-button" title="Next page" aria-label="Next page">
      &gt;
     </button>
   </nav>`}return z}const Q=document.querySelector(".filter-form"),y=document.querySelector('[name="order"]'),h=document.querySelector(".listbox");let E=!1;const X=Array.from(y.children);X.forEach(e=>{const n=e.value,t=e.textContent;ee(n,t)});y.addEventListener("click",e=>{E?w():(h.classList.remove("visually-hidden"),E=!0)});function ee(e,n){const t=document.createElement("button");t.classList.add("listbox-item"),t.dataset.value=e,t.textContent=n,t.type="button",t.addEventListener("click",()=>{y.value=e,Q.dispatchEvent(new Event("change")),w()}),h.append(t)}function w(){h.classList.add("visually-hidden"),E=!1}document.addEventListener("click",e=>{const n=e.target;!h.contains(n)&&!y.contains(n)&&w()});let s=1,f,p,g,m,P=10,A;const te=document.querySelector(".filter-form");let T=document.querySelector('[name="comic"]'),b=document.querySelector('[name="name"]'),ne=document.querySelector('[name="order"]'),H=document.querySelector('[name="date"]');const c=document.querySelector(".gallery");c.addEventListener("click",le);let S=null,C="";C+=`<option>All Years</option>
<option class="defolt-options">-----------</option>`;for(let e=1939;e<=2023;e++)C+=`<option>${e}</option>`;H.insertAdjacentHTML("beforeend",C);H.addEventListener("change",ae);async function ae(e){e.preventDefault,e.target.value==="All Years"?S=null:S=e.target.value}T.addEventListener("input",q(function(e){const n=e.target,t=n.value;/^\d*$/.test(t)||(n.value=t.replace(/\D/g,""),M("warn","Only Numbers can be entered..."))},500));b.addEventListener("input",q(function(e){const n=e.target,t=n.value;/^[a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]*$/.test(t)||(n.value=t.replace(/[^a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/g,""),M("warn","Please, use English keyboard layout only."))},500));const W=document.querySelector(".header-input");W.addEventListener("input",q(ie,500));async function ie(){const e=this.value.trim();if(e.length<2){this.setAttribute("list","");return}const t=(await N.getAllCharacters({nameStartsWith:e})).results,i=document.createElement("datalist");i.id="search-results",t.forEach(r=>{const x=document.createElement("option");x.value=r.name,i.appendChild(x)});const o=document.querySelector("#search-results");o?o.replaceWith(i):this.after(i),this.setAttribute("list","search-results")}const se=document.querySelector(".container");let k=window.getComputedStyle(se).width,u=null;parseInt(k,10)<375&&(k="100");switch(k){case"375px":u=4;break;case"100":u=4;break;case"1440px":u=16;break;default:u=8;break}c.setAttribute("data-limits",u);async function G(e=0){try{const n=ne.value.toLowerCase();let t=0;e!=1&&(t=(e-1)*u),e||(t=0);const i=await N.getAllCharacters({nameStartsWith:b.value,limit:u,offset:t,comics:T.value,orderBy:n,modifiedSince:"01/01/"+S}),o=i.results;return c.setAttribute("data-total",i.total),c.setAttribute("data-offset",i.offset),o.length===0?B():J(o)}catch(n){console.log(n)}}te.addEventListener("change",async e=>{e.preventDefault();const n=document.querySelector(".pagination-container");n&&n.remove(),localStorage.setItem("searchValue",b.value),W.value=b.value,console.log("REBUILD LIST - change on FORM"),c.innerHTML="",c.innerHTML=await G(),await v()});async function v(){const e=document.querySelector(".pagination-container");e&&e.remove(),await ce(),document.getElementById("pagination-numbers").addEventListener("click",V),g=document.getElementById("next-button"),m=document.getElementById("prev-button"),L(),g.addEventListener("click",oe),m.addEventListener("click",re)}async function O(e){const n=document.querySelectorAll(".pagination-number");let t=0,i=0;if(n.forEach((o,r)=>{e===">"?i=P-2:i=1,o.classList.contains("active")&&(t=r)}),e===">"){if(i-t===1)return A={direction:">",button:s},await v(),!1}else if(t-i===1)return A={direction:"<",button:s},await v(),!1;return!0}function oe(){if(O(">")){if(s===Math.ceil(f/p)){L();return}s+=1,_(s)}}function re(){O("<")&&s!==1&&(s-=1,_(s))}function le(e){if(e.target.classList.value==="gallery-image"){const n=Number(e.target.closest("li").dataset.id);Z(n,"")}}async function ce(){p=c.dataset.limits,f=c.dataset.total;const e=await K(p,f,P,s,A);c.insertAdjacentHTML("afterend",e)}function I(e){e.classList.add("disabled"),e.setAttribute("disabled",!0)}function $(e){e.classList.remove("disabled"),e.removeAttribute("disabled")}function L(){s===1?I(m):$(m),Math.ceil(f/p)===s?I(g):$(g)}async function V(e){if(e){const n=e.target;if(s!==Number(n.getAttribute("page-index")))if(n.getAttribute("page-index")!=="..."){if(s=Number(n.getAttribute("page-index")),document.querySelectorAll(".pagination-number").forEach(t=>{t.classList.remove("active"),Number(t.getAttribute("page-index"))==s&&t.classList.add("active")}),s===Math.ceil(f/p)){const t=document.querySelector(".pagination-container");t&&t.remove(),await v()}c.innerHTML="",console.log(`click pagination button with ${s} NUmber`),c.innerHTML=await G(s)}else console.log("перемалювати---- пагінатор")}else document.querySelectorAll(".pagination-number").forEach(n=>{n.classList.remove("active"),Number(n.getAttribute("page-index"))===s&&n.classList.add("active")});L()}const _=e=>{s=e,console.log("PAGE",e),V(),L()};
