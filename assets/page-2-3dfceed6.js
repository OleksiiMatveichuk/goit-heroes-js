import{l as S,c as F,a as C,b as R,r as U,i as I}from"./header-82f447ae.js";async function Y(e,n,t,a){console.log("запрос ",e," ",n," ",t," ",a);let i=Math.ceil(n/e);document.createElement("div").classList.add("my-pagination");const m=await j(),W=await z(m.join(""));function V(r){return r==="..."?a===1||a>t-3?"prev":"next":`Page ${r}`}function _(r){return r===a?`<bitton class="pagination-number active" page-index=${r} aria-label='Page ${r}'>${r}</bitton>`:`<bitton class="pagination-number" page-index=${r} aria-label=${V(r)}>${r}</bitton>`}async function j(r){return G().map(f=>_(f))}function G(r){const s=[];for(let f=1;f<=i;f++)s.push(f);return console.log(i,"<= ",t),i<=t?s:(console.log(a," ",t),a!==i?(s.splice(t-2,0,"...",i),console.log("1arr===",s),s.splice(t,s.length-1),console.log("1arrbutt",s),s):(s.splice(1,0,"..."),console.log("1arr===",s),s.splice(2,s.length-t),s))}async function z(r){return`
        <nav class="pagination-container">
      <button class="pagination-button" id="prev-button" title="Previous page" aria-label="Previous page">
       &lt;
      </button>
  
      <div id="pagination-numbers">

     ${r}

     </div>
  
     <button class="pagination-button" id="next-button" title="Next page" aria-label="Next page">
      &gt;
     </button>
   </nav>`}return W}const Z=document.querySelector(".filter-form"),y=document.querySelector('[name="order"]'),h=document.querySelector(".listbox");let x=!1;const J=Array.from(y.children);J.forEach(e=>{const n=e.value,t=e.textContent;K(n,t)});y.addEventListener("click",e=>{x?O():(h.classList.remove("visually-hidden"),x=!0)});function K(e,n){const t=document.createElement("button");t.classList.add("listbox-item"),t.dataset.value=e,t.textContent=n,t.type="button",t.addEventListener("click",()=>{y.value=e,Z.dispatchEvent(new Event("change")),O()}),h.append(t)}function O(){h.classList.add("visually-hidden"),x=!1}document.addEventListener("click",e=>{const n=e.target;!h.contains(n)&&!y.contains(n)&&O()});let o=1,u,d,p,b,Q=10;const X=document.querySelector(".filter-form");let N=document.querySelector('[name="comic"]'),v=document.querySelector('[name="name"]'),ee=document.querySelector('[name="order"]'),$=document.querySelector('[name="date"]');const l=document.querySelector(".gallery");l.addEventListener("click",re);let A=null,w="";w+=`<option>All Years</option>
<option class="defolt-options">-----------</option>`;for(let e=1939;e<=2023;e++)w+=`<option>${e}</option>`;$.insertAdjacentHTML("beforeend",w);$.addEventListener("change",te);async function te(e){e.preventDefault,e.target.value==="All Years"?A=null:A=e.target.value}N.addEventListener("input",S(function(e){const n=e.target,t=n.value;/^\d*$/.test(t)||(n.value=t.replace(/\D/g,""),I("warn","Only Numbers can be entered..."))},500));v.addEventListener("input",S(function(e){const n=e.target,t=n.value;/^[a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]*$/.test(t)||(n.value=t.replace(/[^a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/g,""),I("warn","Please, use English keyboard layout only."))},500));const M=document.querySelector(".header-input");M.addEventListener("input",S(ne,500));async function ne(){const e=this.value.trim();if(e.length<2){this.setAttribute("list","");return}const t=(await C.getAllCharacters({nameStartsWith:e})).results,a=document.createElement("datalist");a.id="search-results",t.forEach(g=>{const m=document.createElement("option");m.value=g.name,a.appendChild(m)});const i=document.querySelector("#search-results");i?i.replaceWith(a):this.after(a),this.setAttribute("list","search-results")}const ae=document.querySelector(".container");let E=window.getComputedStyle(ae).width,c=null;parseInt(E,10)<375&&(E="100");switch(E){case"375px":c=4;break;case"100":c=4;break;case"1440px":c=16;break;default:c=8;break}l.setAttribute("data-limits",c);async function P(e=0){try{const n=ee.value.toLowerCase();let t=0;e!=1&&(t=(e-1)*c),e||(t=0),console.log("offset value",t);const a=await C.getAllCharacters({nameStartsWith:v.value,limit:c,offset:t,comics:N.value,orderBy:n,modifiedSince:"01/01/"+A});console.log("Data after request",a);const i=a.results;return l.setAttribute("data-total",a.total),l.setAttribute("data-offset",a.offset),i.length===0?R():U(i)}catch(n){console.log(n)}}X.addEventListener("change",async e=>{e.preventDefault();const n=document.querySelector(".pagination-container");n&&n.remove(),localStorage.setItem("searchValue",v.value),M.value=v.value,console.log("REBUILD LIST - change on FORM"),l.innerHTML="",l.innerHTML=await P(),await D()});async function D(){await se(),document.getElementById("pagination-numbers").addEventListener("click",T),p=document.getElementById("next-button"),b=document.getElementById("prev-button"),L(),p.addEventListener("click",oe),b.addEventListener("click",ie)}function B(e){const n=document.querySelectorAll(".pagination-number");let t=0,a=0;if(n.forEach((i,g)=>{i.getAttribute("page-index")==="..."&&(a=g),i.classList.contains("active")&&(t=g)}),e===">"){if(a-t===1)return console.log("перемальовуємо >>>>> paginator"),!1}else if(t-a===1)return console.log("перемальовуємо <<<<<<< paginator"),!1;return!0}function oe(){if(!B(">")){console.log("OOOOOOOOOOOOOOOOOOOOOO");return}if(o===Math.ceil(u/d)){L();return}o+=1,H(o),console.log(o)}function ie(){B("<")&&o!==1&&(o-=1,H(o),console.log(o))}function re(e){if(e.target.classList.value==="gallery-image"){const n=Number(e.target.closest("li").dataset.id);F(n,"")}}async function se(){d=l.dataset.limits,u=l.dataset.total,console.log("paginationLimit",d,"< >pageCount",u);const e=await Y(d,u,Q,o);l.insertAdjacentHTML("afterend",e)}function k(e){e.classList.add("disabled"),e.setAttribute("disabled",!0)}function q(e){e.classList.remove("disabled"),e.removeAttribute("disabled")}function L(){o===1?k(b):q(b),Math.ceil(u/d)===o?k(p):q(p)}async function T(e){if(e){const n=e.target;if(o!==Number(n.getAttribute("page-index")))if(console.log(e.target.getAttribute("page-index")),n.getAttribute("page-index")!=="..."){if(o=Number(n.getAttribute("page-index")),document.querySelectorAll(".pagination-number").forEach(t=>{t.classList.remove("active"),Number(t.getAttribute("page-index"))==o&&t.classList.add("active")}),o===Math.ceil(u/d)){console.log("перемалювати пагінатор currentPage === pageCount ");const t=document.querySelector(".pagination-container");t&&t.remove(),await D()}l.innerHTML="",console.log(`click pagination button with ${o} NUmber`),l.innerHTML=await P(o)}else console.log("перемалювати---- пагінатор")}else document.querySelectorAll(".pagination-number").forEach(n=>{n.classList.remove("active"),Number(n.getAttribute("page-index"))===o&&n.classList.add("active")});L()}const H=e=>{o=e,T(),L()};
