import{l as H,c as G,a as I,b as R,r as V}from"./header-dfd15d44.js";async function W(e,t){let n=Math.ceil(t/e);document.createElement("div").classList.add("my-pagination");const o=await N(),c=await T(o.join(""));function m(u){return`<bitton class="pagination-number" page-index=${u} aria-label='Page ${u}'>${u}</bitton>`}async function N(u){let w=[];for(let h=1;h<=n;h++)w.push(m(h));return w}async function T(u){return`
        <nav class="pagination-container">
      <button class="pagination-button" id="prev-button" title="Previous page" aria-label="Previous page">
       &lt;
      </button>
  
      <div id="pagination-numbers">

     ${u}

     </div>
  
     <button class="pagination-button" id="next-button" title="Next page" aria-label="Next page">
      &gt;
     </button>
   </nav>`}return c}const _=document.querySelector(".filter-form"),v=document.querySelector('[name="order"]'),b=document.querySelector(".listbox");let L=!1;const j=Array.from(v.children);j.forEach(e=>{const t=e.value,n=e.textContent;O(t,n)});v.addEventListener("click",e=>{L?x():(b.classList.remove("visually-hidden"),L=!0)});function O(e,t){const n=document.createElement("button");n.classList.add("listbox-item"),n.dataset.value=e,n.textContent=t,n.type="button",n.addEventListener("click",()=>{v.value=e,_.dispatchEvent(new Event("change")),x()}),b.append(n)}function x(){b.classList.add("visually-hidden"),L=!1}document.addEventListener("click",e=>{const t=e.target;!b.contains(t)&&!v.contains(t)&&x()});let a=1,d,l,g,f;const z=document.querySelector(".filter-form");let B=document.querySelector('[name="comic"]'),p=document.querySelector('[name="name"]'),F=document.querySelector('[name="order"]'),P=document.querySelector('[name="date"]');const r=document.querySelector(".gallery");r.addEventListener("click",Q);let E=null,S="";S+=`<option>All Years</option>
<option class="defolt-options">-----------</option>`;for(let e=1939;e<=2023;e++)S+=`<option>${e}</option>`;P.insertAdjacentHTML("beforeend",S);P.addEventListener("change",U);async function U(e){e.preventDefault,e.target.value==="All Years"?E=null:E=e.target.value}B.addEventListener("input",function(e){const t=e.target,n=t.value;/^\d*$/.test(n)||(t.value=n.replace(/\D/g,""))});p.addEventListener("input",function(e){const t=e.target,n=t.value;/^[a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]*$/.test(n)||(t.value=n.replace(/[^a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/g,""))});const M=document.querySelector(".header-input");M.addEventListener("input",H(Y,500));async function Y(){const e=this.value.trim();if(e.length<2){this.setAttribute("list","");return}const n=(await I.getAllCharacters({nameStartsWith:e})).results,i=document.createElement("datalist");i.id="search-results",n.forEach(c=>{const m=document.createElement("option");m.value=c.name,i.appendChild(m)});const o=document.querySelector("#search-results");o?o.replaceWith(i):this.after(i),this.setAttribute("list","search-results")}const Z=document.querySelector(".container");let A=window.getComputedStyle(Z).width,s=null;parseInt(A,10)<375&&(A="100");switch(A){case"375px":s=4;break;case"100":s=4;break;case"1440px":s=16;break;default:s=8;break}r.setAttribute("data-limits",s);async function D(e=0){try{const t=F.value.toLowerCase();let n=0;e!=1&&(n=(e-1)*s),e||(n=0),console.log("offset value",n);const i=await I.getAllCharacters({nameStartsWith:p.value,limit:s,offset:n,comics:B.value,orderBy:t,modifiedSince:"01/01/"+E});console.log("Data after request",i);const o=i.results;return r.setAttribute("data-total",i.total),r.setAttribute("data-offset",i.offset),o.length===0?R():V(o)}catch(t){console.log(t)}}z.addEventListener("change",async e=>{e.preventDefault();const t=document.querySelector(".pagination-container");t&&t.remove(),localStorage.setItem("searchValue",p.value),M.value=p.value,console.log("REBUILD LIST - change on FORM"),r.innerHTML="",r.innerHTML=await D(),await X(),document.getElementById("pagination-numbers").addEventListener("click",$),g=document.getElementById("next-button"),f=document.getElementById("prev-button"),y(),q(a),g.addEventListener("click",J),f.addEventListener("click",K)});function J(){if(a===Math.ceil(d/l)){y();return}a+=1,q(a)}function K(){a!==1&&(a-=1,q(a))}function Q(e){if(e.target.classList.value==="gallery-image"){const t=Number(e.target.closest("li").dataset.id);G(t,"")}}async function X(){l=r.dataset.limits,d=26;const e=await W(l,d);r.insertAdjacentHTML("afterend",e)}function k(e){e.classList.add("disabled"),e.setAttribute("disabled",!0)}function C(e){e.classList.remove("disabled"),e.removeAttribute("disabled")}function y(){a===1?k(f):C(f),console.log(Math.ceil(d/l),"===",a),Math.ceil(d/l)===a?(console.log("desebl"),k(g)):C(g)}async function $(e){if(e){console.log(e.target.getAttribute("page-index"));const t=e.target;a=Number(t.getAttribute("page-index")),document.querySelectorAll(".pagination-number").forEach(n=>{n.classList.remove("active"),Number(n.getAttribute("page-index"))==a&&n.classList.add("active")}),r.innerHTML="",console.log(`click pagination button with ${a} NUmber`),r.innerHTML=await D(a)}else document.querySelectorAll(".pagination-number").forEach(t=>{t.classList.remove("active"),Number(t.getAttribute("page-index"))===a&&t.classList.add("active")});y()}const q=e=>{a=e,$(),y();const t=(e-1)*l,n=e*l;document.querySelectorAll(".gallery-item").forEach((o,c)=>{o.classList.add("hidden"),c>=t&&c<n&&o.classList.remove("hidden")})};
