import{l as L,c as P,a as k,b as H,r as $,i as C}from"./header-82f447ae.js";const G=document.querySelector(".filter-form"),f=document.querySelector('[name="order"]'),p=document.querySelector(".listbox");let y=!1;const R=Array.from(f.children);R.forEach(e=>{const t=e.value,n=e.textContent;W(t,n)});f.addEventListener("click",e=>{y?A():(p.classList.remove("visually-hidden"),y=!0)});function W(e,t){const n=document.createElement("button");n.classList.add("listbox-item"),n.dataset.value=e,n.textContent=t,n.type="button",n.addEventListener("click",()=>{f.value=e,G.dispatchEvent(new Event("change")),A()}),p.append(n)}function A(){p.classList.add("visually-hidden"),y=!1}document.addEventListener("click",e=>{const t=e.target;!p.contains(t)&&!f.contains(t)&&A()});let a=1,c,s,d,g,O=10;const V=document.querySelector(".filter-form");let I=document.querySelector('[name="comic"]'),m=document.querySelector('[name="name"]'),U=document.querySelector('[name="order"]'),B=document.querySelector('[name="date"]');const o=document.querySelector(".gallery");o.addEventListener("click",Z);let b=null,E="";E+=`<option>All Years</option>
<option class="defolt-options">-----------</option>`;for(let e=1939;e<=2023;e++)E+=`<option>${e}</option>`;B.insertAdjacentHTML("beforeend",E);B.addEventListener("change",_);async function _(e){e.preventDefault,e.target.value==="All Years"?b=null:b=e.target.value}I.addEventListener("input",L(function(e){const t=e.target,n=t.value;/^\d*$/.test(n)||(t.value=n.replace(/\D/g,""),C("warn","Only Numbers can be entered..."))},500));m.addEventListener("input",L(function(e){const t=e.target,n=t.value;/^[a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]*$/.test(n)||(t.value=n.replace(/[^a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/g,""),C("warn","Please, use English keyboard layout only."))},500));const M=document.querySelector(".header-input");M.addEventListener("input",L(j,500));async function j(){const e=this.value.trim();if(e.length<2){this.setAttribute("list","");return}const n=(await k.getAllCharacters({nameStartsWith:e})).results,i=document.createElement("datalist");i.id="search-results",n.forEach(u=>{const x=document.createElement("option");x.value=u.name,i.appendChild(x)});const r=document.querySelector("#search-results");r?r.replaceWith(i):this.after(i),this.setAttribute("list","search-results")}const z=document.querySelector(".container");let h=window.getComputedStyle(z).width,l=null;parseInt(h,10)<375&&(h="100");switch(h){case"375px":l=4;break;case"100":l=4;break;case"1440px":l=16;break;default:l=8;break}o.setAttribute("data-limits",l);async function D(e=0){try{const t=U.value.toLowerCase();let n=0;e!=1&&(n=(e-1)*l),e||(n=0),console.log("offset value",n);const i=await k.getAllCharacters({nameStartsWith:m.value,limit:l,offset:n,comics:I.value,orderBy:t,modifiedSince:"01/01/"+b});console.log("Data after request",i);const r=i.results;return o.setAttribute("data-total",i.total),o.setAttribute("data-offset",i.offset),r.length===0?H():$(r)}catch(t){console.log(t)}}V.addEventListener("change",async e=>{e.preventDefault();const t=document.querySelector(".pagination-container");t&&t.remove(),localStorage.setItem("searchValue",m.value),M.value=m.value,console.log("REBUILD LIST - change on FORM"),o.innerHTML="",o.innerHTML=await D(),await J(),document.getElementById("pagination-numbers").addEventListener("click",T),d=document.getElementById("next-button"),g=document.getElementById("prev-button"),v(),S(a),d.addEventListener("click",F),g.addEventListener("click",Y)});function N(e){console.log(a);const t=document.querySelectorAll(".pagination-number");if(e===">"){if(t[a].getAttribute("page-index")==="...")return console.log("перемальовуємо paginator"),!1}else if(Number(t[t.length-1].getAttribute("page-index"))===a&&t[t.length-1].previousSibling.getAttribute("page-index")==="...")return console.log("перемальовуємо paginator"),!1;return!0}function F(){if(N(">")){if(a===Math.ceil(c/s)){v();return}a+=1,S(a)}}function Y(){N("<")&&a!==1&&(a-=1,S(a))}function Z(e){if(e.target.classList.value==="gallery-image"){const t=Number(e.target.closest("li").dataset.id);P(t,"")}}async function J(){s=o.dataset.limits,c=o.dataset.total,console.log("paginationLimit",s,"< >pageCount",c);const e=await createPagination(s,c,O);o.insertAdjacentHTML("afterend",e)}function q(e){e.classList.add("disabled"),e.setAttribute("disabled",!0)}function w(e){e.classList.remove("disabled"),e.removeAttribute("disabled")}function v(){a===1?q(g):w(g),Math.ceil(c/s)===a?q(d):w(d)}async function T(e){if(e){console.log(e.target.getAttribute("page-index"));const t=e.target;console.log("PAGE NUMBER=",t.getAttribute("page-index")),t.getAttribute("page-index")!=="..."?(a=Number(t.getAttribute("page-index")),document.querySelectorAll(".pagination-number").forEach(n=>{n.classList.remove("active"),Number(n.getAttribute("page-index"))==a&&n.classList.add("active")}),o.innerHTML="",console.log(`click pagination button with ${a} NUmber`),o.innerHTML=await D(a)):console.log("перемалювати---- пагінатор")}else document.querySelectorAll(".pagination-number").forEach(t=>{t.classList.remove("active"),Number(t.getAttribute("page-index"))===a&&t.classList.add("active")});v()}const S=e=>{a=e,T(),v();const t=(e-1)*s,n=e*s;document.querySelectorAll(".gallery-item").forEach((r,u)=>{r.classList.add("hidden"),u>=t&&u<n&&r.classList.remove("hidden")})};
