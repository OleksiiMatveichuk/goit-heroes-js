import{l as S,c as V,a as I,b as _,r as j,i as P}from"./header-82f447ae.js";async function U(e,t,n){let a=Math.ceil(t/e);document.createElement("div").classList.add("my-pagination");const d=await R(),f=await O(d.join(""));function G(l){return`<bitton class="pagination-number" page-index=${l} aria-label='Page ${l}'>${l}</bitton>`}async function R(l){return W().map(g=>G(g))}function W(l){const s=[];for(let g=1;g<=a;g++)s.push(g);return console.log(a,"<= ",n),a<=n||(s.splice(n-2,0,"...",a),console.log("1arr===",s),s.splice(n,s.length-1),console.log("1arrbutt",s)),s}async function O(l){return`
        <nav class="pagination-container">
      <button class="pagination-button" id="prev-button" title="Previous page" aria-label="Previous page">
       &lt;
      </button>
  
      <div id="pagination-numbers">

     ${l}

     </div>
  
     <button class="pagination-button" id="next-button" title="Next page" aria-label="Next page">
      &gt;
     </button>
   </nav>`}return f}const z=document.querySelector(".filter-form"),y=document.querySelector('[name="order"]'),h=document.querySelector(".listbox");let A=!1;const F=Array.from(y.children);F.forEach(e=>{const t=e.value,n=e.textContent;Y(t,n)});y.addEventListener("click",e=>{A?w():(h.classList.remove("visually-hidden"),A=!0)});function Y(e,t){const n=document.createElement("button");n.classList.add("listbox-item"),n.dataset.value=e,n.textContent=t,n.type="button",n.addEventListener("click",()=>{y.value=e,z.dispatchEvent(new Event("change")),w()}),h.append(n)}function w(){h.classList.add("visually-hidden"),A=!1}document.addEventListener("click",e=>{const t=e.target;!h.contains(t)&&!y.contains(t)&&w()});let o=1,m,u,p,b,Z=10;const J=document.querySelector(".filter-form");let N=document.querySelector('[name="comic"]'),v=document.querySelector('[name="name"]'),K=document.querySelector('[name="order"]'),M=document.querySelector('[name="date"]');const i=document.querySelector(".gallery");i.addEventListener("click",ae);let x=null,q="";q+=`<option>All Years</option>
<option class="defolt-options">-----------</option>`;for(let e=1939;e<=2023;e++)q+=`<option>${e}</option>`;M.insertAdjacentHTML("beforeend",q);M.addEventListener("change",Q);async function Q(e){e.preventDefault,e.target.value==="All Years"?x=null:x=e.target.value}N.addEventListener("input",S(function(e){const t=e.target,n=t.value;/^\d*$/.test(n)||(t.value=n.replace(/\D/g,""),P("warn","Only Numbers can be entered..."))},500));v.addEventListener("input",S(function(e){const t=e.target,n=t.value;/^[a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]*$/.test(n)||(t.value=n.replace(/[^a-zA-Z0-9\s!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/g,""),P("warn","Please, use English keyboard layout only."))},500));const D=document.querySelector(".header-input");D.addEventListener("input",S(X,500));async function X(){const e=this.value.trim();if(e.length<2){this.setAttribute("list","");return}const n=(await I.getAllCharacters({nameStartsWith:e})).results,a=document.createElement("datalist");a.id="search-results",n.forEach(d=>{const f=document.createElement("option");f.value=d.name,a.appendChild(f)});const r=document.querySelector("#search-results");r?r.replaceWith(a):this.after(a),this.setAttribute("list","search-results")}const ee=document.querySelector(".container");let E=window.getComputedStyle(ee).width,c=null;parseInt(E,10)<375&&(E="100");switch(E){case"375px":c=4;break;case"100":c=4;break;case"1440px":c=16;break;default:c=8;break}i.setAttribute("data-limits",c);async function $(e=0){try{const t=K.value.toLowerCase();let n=0;e!=1&&(n=(e-1)*c),e||(n=0),console.log("offset value",n);const a=await I.getAllCharacters({nameStartsWith:v.value,limit:c,offset:n,comics:N.value,orderBy:t,modifiedSince:"01/01/"+x});console.log("Data after request",a);const r=a.results;return i.setAttribute("data-total",a.total),i.setAttribute("data-offset",a.offset),r.length===0?_():j(r)}catch(t){console.log(t)}}J.addEventListener("change",async e=>{e.preventDefault();const t=document.querySelector(".pagination-container");t&&t.remove(),localStorage.setItem("searchValue",v.value),D.value=v.value,console.log("REBUILD LIST - change on FORM"),i.innerHTML="",i.innerHTML=await $(),await oe(),document.getElementById("pagination-numbers").addEventListener("click",H),p=document.getElementById("next-button"),b=document.getElementById("prev-button"),L(),k(o),p.addEventListener("click",te),b.addEventListener("click",ne)});function T(e){console.log(o);const t=document.querySelectorAll(".pagination-number");if(e===">"){if(t[o].getAttribute("page-index")==="...")return console.log("перемальовуємо paginator"),!1}else if(Number(t[t.length-1].getAttribute("page-index"))===o&&t[t.length-1].previousSibling.getAttribute("page-index")==="...")return console.log("перемальовуємо paginator"),!1;return!0}function te(){if(T(">")){if(o===Math.ceil(m/u)){L();return}o+=1,k(o)}}function ne(){T("<")&&o!==1&&(o-=1,k(o))}function ae(e){if(e.target.classList.value==="gallery-image"){const t=Number(e.target.closest("li").dataset.id);V(t,"")}}async function oe(){u=i.dataset.limits,m=i.dataset.total,console.log("paginationLimit",u,"< >pageCount",m);const e=await U(u,m,Z);i.insertAdjacentHTML("afterend",e)}function C(e){e.classList.add("disabled"),e.setAttribute("disabled",!0)}function B(e){e.classList.remove("disabled"),e.removeAttribute("disabled")}function L(){o===1?C(b):B(b),Math.ceil(m/u)===o?C(p):B(p)}async function H(e){if(e){console.log(e.target.getAttribute("page-index"));const t=e.target;console.log("PAGE NUMBER=",t.getAttribute("page-index")),t.getAttribute("page-index")!=="..."?(o=Number(t.getAttribute("page-index")),document.querySelectorAll(".pagination-number").forEach(n=>{n.classList.remove("active"),Number(n.getAttribute("page-index"))==o&&n.classList.add("active")}),i.innerHTML="",console.log(`click pagination button with ${o} NUmber`),i.innerHTML=await $(o)):console.log("перемалювати---- пагінатор")}else document.querySelectorAll(".pagination-number").forEach(t=>{t.classList.remove("active"),Number(t.getAttribute("page-index"))===o&&t.classList.add("active")});L()}const k=e=>{o=e,H(),L();const t=(e-1)*u,n=e*u;document.querySelectorAll(".gallery-item").forEach((r,d)=>{r.classList.add("hidden"),d>=t&&d<n&&r.classList.remove("hidden")})};
